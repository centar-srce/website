---
import { Image } from 'astro:assets';
import popup from '../assets/popup.png';
---

<div
	id="popup"
	class="pointer-events-none fixed inset-0 z-10 flex items-center justify-center bg-white p-6 opacity-0 transition-opacity duration-300"
>
	<div
		class="absolute inset-6 -top-1/6 flex flex-col items-center justify-center md:top-0 md:flex-row"
	>
		<Image
			class="w-[300px] md:w-[400px]"
			src={popup}
			alt=""
			densities={[1, 2]}
		/>
		<div class="flex flex-col gap-4">
			<p class="text-neutral text-center text-sm">
				Hej, Srce je budno i noću:<br />
				05.09.&ndash;27.12.2025.<br />petkom i subotom<br />smo tu za tebe do 3
				iza ponoći.<br />Nisi sam/a i kad je najtiše.
			</p>
			<a
				id="popup_button"
				class="bg-brand cursor-pointer rounded-sm px-3 py-1.5 text-center text-sm text-white transition-colors hover:bg-purple-800"
				onclick="closePopup()"
			>
				Nastavi na Centar Srce
			</a>
		</div>
	</div>
</div>

<script>
	function popupSeen(): boolean {
		return sessionStorage?.getItem('popupSeen') === 'true';
	}

	function showPopup() {
		const popup = document.getElementById('popup');
		if (!popup || !sessionStorage) return;
		popup.classList.remove('opacity-0');
		popup.classList.remove('pointer-events-none');
		popup.classList.add('opacity-100');
		document.body.style.overflow = 'hidden';
		sessionStorage.setItem('popupSeen', 'true');
	}

	function closePopup() {
		const popup = document.getElementById('popup');
		if (!popup) return;
		popup.classList.remove('opacity-100');
		popup.classList.add('opacity-0');
		popup.classList.add('pointer-events-none');
		document.body.style.overflow = '';
	}

	onload = () => {
		if (!popupSeen()) {
			showPopup();
		}
	};

	document
		.getElementById('popup_button')
		?.addEventListener('click', closePopup);
</script>
